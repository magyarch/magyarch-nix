
# See https://wiki.hyprland.org/Configuring/Monitors/

# ───────────────────────────────
# 🖥️ Monitor beállítások
# ───────────────────────────────
# Példa: monitor=DP-2,2560x1440@144,0x0,1.2
monitor = ,preferred,auto,1.25
#monitor = ,highrr,auto,1.33
#monitor = ,highres,auto,1.33


# ───────────────────────────────
# 🚀 Autostart programok
# ───────────────────────────────
# Polkit (válassz 1 verziót ha szükséges)
#exec-once = /nix/store/$(ls -la /nix/store | grep 'polkit-gnome' | grep '4096' | awk '{print $9}' | sed -n '$p')/libexec/polkit-gnome-authentication-agent-1
#exec-once = /nix/store/$(ls -la /nix/store | grep 'mate-polkit' | grep '4096' | awk '{print $9}' | sed -n '$p')/libexec/polkit-mate-authentication-agent-1

exec-once = waybar
exec-once = mako
exec-once = wlsunset -l 47.6 -L 16.6
exec-once = eww daemon
exec-once = hyprctl dispatch dpms on
exec-once = nm-applet
exec-once = /run/current-system/sw/bin/pypr
exec-once = copyq --start-server
exec-once = hyprpaper
exec-once = hyprpolkitagent
exec-once = hyprctl setcursor Bibata-Modern-Ice 24

# Környezeti változók frissítése (lassú indítás fix)
exec-once = systemctl --user import-environment
exec-once = hash dbus-update-activation-environment 2>/dev/null
exec-once = dbus-update-activation-environment --systemd

# Példák (opcionális):
#exec-once = systemctl --user enable --now hyprpolkitagent.service
#exec-once = xhost +SI:localuser:root && sudo nvidiafan2.sh
#exec-once = sudo /home/xeoncpu/.local/bin/nvidiafan2.sh
#exec = sudo /home/xeoncpu/.local/bin/vega64-undervolt.sh
#exec-once = /nix/store/.../bin/plexmediaserver "$@"


# ───────────────────────────────
# 🪟 XWayland beállítások
# ───────────────────────────────
xwayland {
    enabled = true
    force_zero_scaling = true
    use_nearest_neighbor = true
}


# ───────────────────────────────
# 🌍 Környezeti változók
# ───────────────────────────────
env = wallpaper_path, $HOME/.local/bin/wallpapers/Future
env = LIBVA_DRIVER_NAME, radeonsi
env = MOZ_ENABLE_WAYLAND, 1
env = __GLX_VENDOR_LIBRARY_NAME, radeonsi
env = MESA_GL_VERSION_OVERRIDE, 4.6
env = MESA_GLSL_VERSION_OVERRIDE, 460
env = RADV_PERFTEST, aco
env = WLR_DRM_NO_ATOMIC, 0
env = WLR_RENDERER_ALLOW_SOFTWARE, 0
env = WLR_RENDERER, vulkan

# NVIDIA-hoz / alternatív driverekhez:
#env = NVD_BACKEND, direct
#env = GBM_BACKEND, nvidia-drm
#env = EGL_PLATFORM, wayland
#env = WLR_NO_HARDWARE_CURSORS, 1
#env = DXVK_BACKEND, nvidia
#env = STEAM_FORCE_DESKTOPUI_SCALING, 1.33
#env = __GL_GSYNC_ALLOWED, 1
#env = GDK_BACKEND, wayland,x11
#env = LD_LIBRARY_PATH, /run/opengl-driver/lib
#env = lact, gui


# ───────────────────────────────
# ⌨️ Input beállítások
# ───────────────────────────────
input {
    kb_layout = hu
    kb_variant =
    kb_model = 105
    kb_options =
    kb_rules =

    follow_mouse = 1
    accel_profile = flat
    mouse_refocus = false
    repeat_delay = 300
    repeat_rate = 25
    sensitivity = 0  # -1.0 - 1.0, 0 = semmi módosítás

    touchpad {
        natural_scroll = no
    }
}


# ───────────────────────────────
# ⚙️ Általános beállítások
# ───────────────────────────────
general {
    gaps_in = 6
    gaps_out = 12
    border_size = 2

    col.active_border = rgba(6272a4cc)
    col.inactive_border = rgba(3c3c3c99)

    resize_on_border = true
    extend_border_grab_area = 10
    hover_icon_on_border = true
    layout = dwindle

    #allow_tearing = true  # ha nem kell fade a háttérváltáskor
}

    
# ───────────────────────────────
# 🧱 Dwindle layout
# ───────────────────────────────
dwindle {
    pseudotile = true
    preserve_split = true
    force_split = 2
    special_scale_factor = 0.8
    split_width_multiplier = 1.0
    #use_active_for_splits = true
}


# ───────────────────────────────
# 🧍 Master layout
# ───────────────────────────────
master {
    new_status = false
    mfact = 0.50
    smart_resizing = true
    inherit_fullscreen = true
    #no_gaps_when_only = true
    #always_center_master = false
}


# ───────────────────────────────
# ✨ Dekorációk, blur, árnyék
# ───────────────────────────────
decoration {
    rounding = 12

    blur {
        enabled = true
        size = 15
        passes = 2
        new_optimizations = true
    }

    shadow {
        enabled = false
        ignore_window = true
        range = 4
        offset = 0 2
        render_power = 2
        color = rgba(0000002A)
    }
}


# ───────────────────────────────
# ✨ Animations
# ───────────────────────────────
animations {
    enabled = true

    # ── Bézier görbék (saját görbék az animációkhoz)
    bezier = easeOutQuint, 0.23, 1, 0.32, 1
    bezier = easeInOutCubic, 0.65, 0.05, 0.36, 1
    bezier = linear, 0, 0, 1, 1
    bezier = almostLinear, 0.5, 0.5, 0.75, 1.0
    bezier = quick, 0.15, 0, 0.1, 1

    # ── Globális animációk
    animation = global,        1, 10, default
    animation = border,        1, 5.39, easeOutQuint
    animation = windows,       1, 4.79, easeOutQuint
    animation = windowsIn,     1, 4.10, easeOutQuint, popin 87%
    animation = windowsOut,    1, 1.49, linear,       popin 87%

    # ── Áttűnések
    animation = fadeIn,        1, 1.73, almostLinear
    animation = fadeOut,       1, 1.46, almostLinear
    animation = fade,          1, 3.03, quick

    # ── Rétegek (pl. Waybar, wlogout)
    animation = layers,        1, 3.81, easeOutQuint
    animation = layersIn,      1, 4.00, easeOutQuint, fade
    animation = layersOut,     1, 1.50, linear, fade
    animation = fadeLayersIn,  1, 1.79, almostLinear
    animation = fadeLayersOut, 1, 1.39, almostLinear

    # ── Munkaterületek váltása
    animation = workspaces,    1, 1.94, almostLinear, fade
    animation = workspacesIn,  1, 1.21, almostLinear, fade
    animation = workspacesOut, 1, 1.94, almostLinear, fade

    # ── Egyszerűsített presetek (referencia)
    # animation = windows, 1, 1, default
    # animation = windowsOut, 1, 1, default
    # animation = fade, 1, 1, default
    # animation = workspaces, 1, 2, default
}


# ───────────────────────────────
# 🧩 Group és Groupbar
# ───────────────────────────────
group {
    auto_group = true
    drag_into_group = 1
    col.border_active = 0xff6272a4
    col.border_inactive = 0xff282a36

    groupbar {
        enabled = true
        gradients = true
        render_titles = true
        col.active = 0xff6272a4
        col.inactive = 0xff282a36
        text_color = 0xffc3cdc8
        font_family = "JetBrainsMono Nerd Font"
        font_size = 10
        height = 14
    }
}


# ───────────────────────────────
# ⚙️ Misc (általános opciók)
# ───────────────────────────────
misc {
    disable_hyprland_logo = true
    vfr = true
    vrr = 2
    enable_swallow = true
    swallow_regex = ^(kitty)$
}


# ───────────────────────────────
# 🖼️ Renderelés
# https://wiki.hyprland.org/Configuring/Variables/#render
# ───────────────────────────────
render {
    direct_scanout = true
    #expand_undersized_textures = true
}


# ───────────────────────────────
# 🖱️ Egérkurzor beállítások
# ───────────────────────────────
cursor {
    no_hardware_cursors = true
    inactive_timeout = 3
}
# See https://wiki.hyprland.org/Configuring/Keywords/ for more
# ───────────────────────────────
# 🪟 Window Rules
# ───────────────────────────────

# Appok fix workspace-hez kötése
windowrulev2 = workspace 1, class:^(firefox-esr)$
windowrulev2 = workspace 2, class:^(discord)$
windowrulev2 = workspace 3, class:^(code)$
windowrulev2 = workspace 4, class:^(mpv)$
windowrulev2 = workspace 5, class:^(org.qbittorrent.qBittorrent)$
windowrulev2 = workspace 6, class:^(steam)$
windowrulev2 = workspace 7, class:^(lutris)$
windowrulev2 = workspace 8, class:^(thunar)$


# Terminálok, wofi, lebegők
windowrulev2 = float, class:^(kitty-dropterm|wofi|Wofi)$
windowrulev2 = opacity 0.8 0.8, class:^(kitty-dropterm|Alacritty|kitty)$
windowrulev2 = center, class:^(kitty-dropterm|wofi|Wofi)$

# Fullscreen szabály
windowrulev2 = noborder, fullscreen:1

# mpv lebegő méret/pozíció
windowrulev2 = float, title:^(mpv|launcher)$
windowrulev2 = move 25%-  , title:^(mpv)$
windowrulev2 = size 35% 45%, title:^(mpv)$

# Steam és Thunar dialógusok külön kezelése
windowrulev2 = float, class:^([Ss]team)$, title:negative:^([Ss]team)$
windowrulev2 = float, class:^([Tt]hunar)$, title:negative:(.*[Tt]hunar.*)
windowrulev2 = center, class:^([Tt]hunar)$, title:negative:(.*[Tt]hunar.*)

# windowrule = scale 1.5, class:^(steam)$, title:^Steam$

# Terminál animáció
windowrule = animation slide right, class:^(kitty|Alacritty)$


# ────────────────
# Common modals
# ────────────────
windowrule = float, title:^(Open|Choose Files|Save As|Confirm to replace files|File Operation Progress)$
windowrulev2 = float, class:^(xdg-desktop-portal-gtk)$, title:^(Save File)$
windowrulev2 = float, class:^(brave)$, title:^(Open File)$


# ────────────────
# Pavucontrol
# ────────────────
windowrulev2 = float, class:^(org.pulseaudio.pavucontrol)$
windowrulev2 = size 1200 800, class:^(pavucontrol)$
windowrulev2 = center, class:^(pavucontrol)$
windowrulev2 = opacity 0.9 0.9, class:^(pavucontrol)$


# ────────────────
# Egyéb GUI beállítók
# ────────────────
windowrulev2 = float, class:^(nwg-look)$
windowrulev2 = size 1200 800, class:^(nwg-look)$

windowrulev2 = float, class:^(blueman-manager)$
windowrulev2 = float, class:^(nm-applet)$


# ────────────────
# Picture-in-Picture
# ────────────────
windowrulev2 = float, title:^(Picture-in-Picture)$
windowrulev2 = pin, title:^(Picture-in-Picture)$
# windowrulev2 = size 450 300, title:^(Picture-in-Picture)$


# ───────────────────────────────
# 🧩 Layer Rules
# ───────────────────────────────
layerrule = animation slide top, logout_dialog
layerrule = animation slide down, waybar
layerrule = animation fade 50%, wallpaper

# ──────────────────────────────────────────────
#  Main modifier
# ──────────────────────────────────────────────
$mainMod = SUPER

# ──────────────────────────────────────────────
#  Alap programindítások
# ──────────────────────────────────────────────
bind = $mainMod, Return, exec, alacritty
bind = $mainMod, D, exec, wofi --show drun --allow-images
bind = $mainMod, R, exec, alacritty -e vifmrun
bind = $mainMod, C, exec, wlogout
bind = $mainMod, P, exec, discord
bind = $mainMod SHIFT, P, exec, thunar
bind = $mainMod SHIFT, E, exec, subl
bind = $mainMod, B, exec, rofi-bookmarks
bind = $mainMod, W, exec, firefox-esr
bind = $mainMod SHIFT, W, exec, brave --enable-features=UseOzonePlatform --ozone-platform=wayland --password-store=basic

# ──────────────────────────────────────────────
#  Pypr plugin funkciók
# ──────────────────────────────────────────────
bind = $mainMod SHIFT, B, exec, pypr expose
bind = $mainMod, Z, exec, pypr zoom   # Toggle zoom
workspace = special:exposed,gapsout:60,gapsin:40,bordersize:5,border:true,shadow:false

# ──────────────────────────────────────────────
#  Ablakkezelés / Layout
# ──────────────────────────────────────────────
bind = $mainMod, F, fullscreen,
bind = $mainMod CTRL, F, fullscreenstate, 0 3   # Fake fullscreen toggle
bind = $mainMod, SPACE, togglefloating,
bind = $mainMod SHIFT, SPACE, togglesplit,
bind = $mainMod SHIFT, C, centerwindow,
bind = $mainMod, V, pseudo,                   # Dwindle
bind = $mainMod, G, changegroupactive,
bind = $mainMod SHIFT, G, togglegroup,
bind = $mainMod SHIFT, A, layoutmsg, removemaster
bind = $mainMod, A, layoutmsg, addmaster
bind = $mainMod SHIFT, TAB, layoutmsg, swapwithmaster
bind = $mainMod SHIFT, R, exec, hyprctl reload

# Layout váltás
bind = ALT, L, exec, hyprctl keyword general:layout "dwindle"
bind = CTRL SHIFT, L, exec, hyprctl keyword general:layout "master"

# ──────────────────────────────────────────────
#  Fókusz és ablak mozgatás
# ──────────────────────────────────────────────
bind = $mainMod, TAB, cyclenext
bind = $mainMod CTRL, H, movewindow, l
bind = $mainMod CTRL, L, movewindow, r
bind = $mainMod CTRL, K, movewindow, u
bind = $mainMod CTRL, J, movewindow, d

# ──────────────────────────────────────────────
#  Ablakméret változtatás
# ──────────────────────────────────────────────
binde = $mainMod SHIFT, left,  resizeactive, -50 0
binde = $mainMod SHIFT, right, resizeactive,  50 0
binde = $mainMod SHIFT, down,  resizeactive,  0 50
binde = $mainMod SHIFT, up,    resizeactive,  0 -50

# ──────────────────────────────────────────────
#  Rendszer / multimédia / képernyőkép
# ──────────────────────────────────────────────
# Hangerő
bind = ALT, UP, exec, wpctl set-volume @DEFAULT_AUDIO_SINK@ 2%+ -l 1
bind = ALT, DOWN, exec, wpctl set-volume @DEFAULT_AUDIO_SINK@ 2%-

# Képernyőkép
bind = ALT, P, exec, hyprshot -m region --clipboard-only
bind = $mainMod, F5, exec, hyprshot -m region
bind = $mainMod, F4, exec, hyprshot -m output

# Egyéb funkcióbillentyűk
bind = $mainMod, F2, exec, gamemode.sh
bind = $mainMod, F8, exec, $HOME/.local/bin/randwall.sh

# ──────────────────────────────────────────────
#  Waybar & egyéb rendszerszintű parancsok
# ──────────────────────────────────────────────
bind = $mainMod CTRL, B, exec, pkill -SIGUSR1 waybar
bind = $mainMod CTRL, Space, exec, dmenu_mpv
bind = $mainMod CTRL, R, exec, screenrec.sh
bind = $mainMod CTRL, T, exec, wofi_session.sh

# ──────────────────────────────────────────────
#  Ablakkezelés / bezárás
# ──────────────────────────────────────────────
bind = $mainMod, Q, killactive
# Move focus with vim like
bind = $mainMod, l, movefocus, l
bind = $mainMod, h, movefocus, r
bind = $mainMod, k, movefocus, u
bind = $mainMod, j, movefocus, d

# Move/resize windows with mainMod + LMB/RMB and dragging
bindm = $mainMod, mouse:272, movewindow
bindm = $mainMod, mouse:273, resizewindow

# Special workspace
#bind = $mainMod SHIFT, space, movetoworkspace, special
#bind = $mainMod, space, togglespecialworkspace,

# Switch workspaces with mainMod + [0-9]
bind = $mainMod, 1, workspace, 1
bind = $mainMod, 2, workspace, 2
bind = $mainMod, 3, workspace, 3
bind = $mainMod, 4, workspace, 4
bind = $mainMod, 5, workspace, 5
bind = $mainMod, 6, workspace, 6
bind = $mainMod, 7, workspace, 7
bind = $mainMod, 8, workspace, 8
bind = $mainMod, 9, workspace, 9
bind = $mainMod, 0, workspace, 10

# Move active window to a workspace with mainMod + SHIFT + [0-9]
bind = $mainMod SHIFT, 1, movetoworkspace, 1
bind = $mainMod SHIFT, 2, movetoworkspace, 2
bind = $mainMod SHIFT, 3, movetoworkspace, 3
bind = $mainMod SHIFT, 4, movetoworkspace, 4
bind = $mainMod SHIFT, 5, movetoworkspace, 5
bind = $mainMod SHIFT, 6, movetoworkspace, 6
bind = $mainMod SHIFT, 7, movetoworkspace, 7
bind = $mainMod SHIFT, 8, movetoworkspace, 8
bind = $mainMod SHIFT, 9, movetoworkspace, 9
bind = $mainMod SHIFT, 0, movetoworkspace, 10

# Scratchpad with specialworkspace
# workspace = name:special:term, gapsout:70, gapsin:10, shadow:false, on-created-empty:kitty
# workspace = name:special:music, gapsout:70, gapsin:10, shadow:false, on-created-empty:kitty -e ncmpcpp
# workspace = name:special:raw, gapsout:70, gapsin:10

# bind = $mainMod SHIFT, Return, togglespecialworkspace, term
# bind = $mainMod SHIFT, N, togglespecialworkspace, music
# bind = ALT, T, togglespecialworkspace, raw
# bind = ALT, M, movetoworkspace, special:raw
# bind = ALT SHIFT, M, movetoworkspace,e+0

bind = $mainMod SHIFT, Return, exec, pypr toggle term
bind = $mainMod SHIFT, N, exec, pypr toggle music
bind = $mainMod SHIFT, V, exec, pypr toggle launcher



# Scroll through existing workspaces with mainMod + scroll
bind = $mainMod, mouse_down, workspace, e+1
bind = $mainMod, mouse_up, workspace, e-1


